"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[573],{3905:(t,e,i)=>{i.d(e,{Zo:()=>p,kt:()=>d});var n=i(7294);function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e){if(null==t)return{};var i,n,a=function(t,e){if(null==t)return{};var i,n,a={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(a[i]=t[i]);return a}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(a[i]=t[i])}return a}var l=n.createContext({}),c=function(t){var e=n.useContext(l),i=e;return t&&(i="function"==typeof t?t(e):o(o({},e),t)),i},p=function(t){var e=c(t.components);return n.createElement(l.Provider,{value:e},t.children)},g="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},u=n.forwardRef((function(t,e){var i=t.components,a=t.mdxType,r=t.originalType,l=t.parentName,p=s(t,["components","mdxType","originalType","parentName"]),g=c(i),u=a,d=g["".concat(l,".").concat(u)]||g[u]||m[u]||r;return i?n.createElement(d,o(o({ref:e},p),{},{components:i})):n.createElement(d,o({ref:e},p))}));function d(t,e){var i=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var r=i.length,o=new Array(r);o[0]=u;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s[g]="string"==typeof t?t:a,o[1]=s;for(var c=2;c<r;c++)o[c]=i[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,i)}u.displayName="MDXCreateElement"},4984:(t,e,i)=>{i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var n=i(7462),a=(i(7294),i(3905));const r={title:"1. Configuring an Application in Azure Active Directory",sidebar_position:1},o=void 0,s={unversionedId:"Authentication-App-With-NextJs-And-Microsoft-Graph/Configuring-Application-Azure-Active-Directory",id:"Authentication-App-With-NextJs-And-Microsoft-Graph/Configuring-Application-Azure-Active-Directory",title:"1. Configuring an Application in Azure Active Directory",description:"In this session, you will learn how to create an application in Azure Active Directory (AAD) and configure the necessary permissions so that the application can access the user's data.",source:"@site/docs/Authentication-App-With-NextJs-And-Microsoft-Graph/01-Configuring-Application-Azure-Active-Directory.md",sourceDirName:"Authentication-App-With-NextJs-And-Microsoft-Graph",slug:"/Authentication-App-With-NextJs-And-Microsoft-Graph/Configuring-Application-Azure-Active-Directory",permalink:"/MicrosoftCloud/tutorials/docs/Authentication-App-With-NextJs-And-Microsoft-Graph/Configuring-Application-Azure-Active-Directory",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"1. Configuring an Application in Azure Active Directory",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Authentication App with Next.js and Microsoft Graph",permalink:"/MicrosoftCloud/tutorials/docs/Authentication-App-With-NextJs-And-Microsoft-Graph/"},next:{title:"2. Structuring the Project",permalink:"/MicrosoftCloud/tutorials/docs/Authentication-App-With-NextJs-And-Microsoft-Graph/Structuring-Project"}},l={},c=[{value:"Step by Step",id:"step-by-step",level:2},{value:"Configure the Application",id:"configure-the-application",level:2}],p={toc:c},g="wrapper";function m(t){let{components:e,...r}=t;return(0,a.kt)(g,(0,n.Z)({},p,r,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In this session, you will learn how to create an application in Azure Active Directory (AAD) and configure the necessary permissions so that the application can access the user's data."),(0,a.kt)("p",null,"Before starting to develop the application, you need to create an application in the Azure Active Directory (AAD). For this, go now to the ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"https://portal.azure.com/"},"Azure Portal")),", use your M365 Developer Program account and click on ",(0,a.kt)("strong",{parentName:"p"},"Azure Active Directory"),"."),(0,a.kt)("p",null,"Now, let's go to the step by step!"),(0,a.kt)("h2",{id:"step-by-step"},"Step by Step"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Go to ",(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("a",{parentName:"strong",href:"https://portal.azure.com/"},"Azure Portal"))," and click on ",(0,a.kt)("strong",{parentName:"li"},"Azure Active Directory"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-01",src:i(7139).Z,title:"Azure Active Directory",width:"1914",height:"1032"})),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Click on ",(0,a.kt)("strong",{parentName:"li"},"App Registrations"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-02",src:i(9321).Z,title:"App Registrations",width:"1914",height:"1032"})),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Click on ",(0,a.kt)("strong",{parentName:"li"},"New Registration"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-03",src:i(6906).Z,title:"New Registration",width:"1914",height:"1032"})),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Fill in the fields as shown below and click on ",(0,a.kt)("strong",{parentName:"li"},"Register"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-04",src:i(6546).Z,title:"Register",width:"1914",height:"1032"})),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Go to ",(0,a.kt)("strong",{parentName:"li"},"Overview")," and copy:")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Application (client) ID")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Directory (tenant) ID"))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-05",src:i(5676).Z,title:"Overview",width:"1914",height:"1032"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"We will use these values to configure the application in the ",(0,a.kt)("inlineCode",{parentName:"p"},"env.local")," file.")),(0,a.kt)("h2",{id:"configure-the-application"},"Configure the Application"),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"Go to ",(0,a.kt)("strong",{parentName:"li"},"Certificates & secrets")," and click on ",(0,a.kt)("strong",{parentName:"li"},"New client secret"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-06",src:i(6045).Z,title:"Certificates & secrets",width:"1914",height:"1032"})),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"Fill the field ",(0,a.kt)("strong",{parentName:"li"},"Description")," and click on ",(0,a.kt)("strong",{parentName:"li"},"Add"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-07",src:i(3801).Z,title:"Description",width:"1914",height:"1047"})),(0,a.kt)("ol",{start:8},(0,a.kt)("li",{parentName:"ol"},"Copy the ",(0,a.kt)("strong",{parentName:"li"},"Value")," of the ",(0,a.kt)("strong",{parentName:"li"},"Client secret"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-08",src:i(2938).Z,title:"Value of Client secret",width:"1914",height:"1047"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Obs.:")," don't forget to save this value, you will need it later. If you lose it, you will need to create a new one.")),(0,a.kt)("ol",{start:9},(0,a.kt)("li",{parentName:"ol"},"Go to ",(0,a.kt)("strong",{parentName:"li"},"API permissions")," and click on ",(0,a.kt)("strong",{parentName:"li"},"Add a permission"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-09",src:i(5554).Z,title:"API permissions",width:"1928",height:"1047"})),(0,a.kt)("ol",{start:10},(0,a.kt)("li",{parentName:"ol"},"Click on ",(0,a.kt)("strong",{parentName:"li"},"Microsoft Graph")," amd then on ",(0,a.kt)("strong",{parentName:"li"},"Delegated permissions"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-111.png",src:i(6090).Z,title:"Delegated permissions",width:"1928",height:"1047"})),(0,a.kt)("ol",{start:11},(0,a.kt)("li",{parentName:"ol"},"Select the following permissions and click on ",(0,a.kt)("strong",{parentName:"li"},"Add permissions"),".")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"email")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"offline_access")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"openid")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Presence.Read")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"profile"))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-11",src:i(6702).Z,title:"Add permissions",width:"1928",height:"1047"})),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-12",src:i(5485).Z,title:"Presence.Read permission",width:"1928",height:"1047"})),(0,a.kt)("ol",{start:12},(0,a.kt)("li",{parentName:"ol"},"Go to ",(0,a.kt)("strong",{parentName:"li"},"Microsoft Graph")," again and click on ",(0,a.kt)("strong",{parentName:"li"},"Application permissions"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-13",src:i(6468).Z,title:"Application permissions",width:"1928",height:"1047"})),(0,a.kt)("ol",{start:13},(0,a.kt)("li",{parentName:"ol"},"Select the following permissions and click on ",(0,a.kt)("strong",{parentName:"li"},"Add permissions"),".")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Presence.ReadWrite.All"),": Allows the app to read all presence information and write activity and availability of all users in the directory without a signed-in user. Presence information includes activity, availability, status note, calendar out-of-office message, time zone and location. ")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-14",src:i(3651).Z,title:"Add permissions",width:"1928",height:"1047"})),(0,a.kt)("ol",{start:14},(0,a.kt)("li",{parentName:"ol"},"Click on ",(0,a.kt)("strong",{parentName:"li"},"Grant admin consent for 'your-tenant-name'")," and click on ",(0,a.kt)("strong",{parentName:"li"},"Yes"),".")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"image-15",src:i(2337).Z,title:"Grant admin consent for tenant name",width:"1928",height:"1047"})),(0,a.kt)("p",null,"Congratulations! YEAH! \ud83c\udf89\ud83c\udf89\ud83c\udf89"),(0,a.kt)("p",null,"You have successfully created an application in Azure Active Directory and configured the necessary permissions so that the application can access the user's data."),(0,a.kt)("p",null,"Now, let's go to the next session!"))}m.isMDXComponent=!0},7139:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-01-5455e7e99bc3c79be78b0674d9aadf89.png"},9321:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-02-c285321d2cb56b5c2fa6c329ac222d28.png"},6906:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-03-530bc02cdc0ea0fd222664447a17456d.png"},6546:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-04-c043fa343dc196745879187dcd62faab.png"},5676:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-05-8c369fb374b9825a0c0f9377bfc8b74b.png"},6045:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-06-ed5531907156f493b6eee972f725344d.png"},3801:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-07-db5c1f42b2d3079590e350fa8ba4ccbb.png"},2938:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-08-3000815597d278da230882b600fd2100.png"},5554:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-09-3679e41b5533b13798a9958eff85f902.png"},6702:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-11-d43060060c4ddf2c0b90e179971676c8.png"},6090:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-111-845126e9d97392fc17dd60985515f73e.png"},5485:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-12-9f36310ccf9ea25e87c59575ea049925.png"},6468:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-13-9a3de33d2d873badd53cf1008678f940.png"},3651:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-14-a5ca1363f60ae225f921dd8325b91298.png"},2337:(t,e,i)=>{i.d(e,{Z:()=>n});const n=i.p+"assets/images/image-15-c0a0c843769de56bd2d040d6fa1950e0.png"}}]);