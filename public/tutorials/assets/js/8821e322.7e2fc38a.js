"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[378],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=a,f=d["".concat(p,".").concat(m)]||d[m]||c[m]||o;return n?r.createElement(f,i(i({ref:t},u),{},{components:n})):r.createElement(f,i({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9568:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var r=n(7462),a=(n(7294),n(3905));const o={title:"6. Creating the Interface file for JWT",sidebar_position:1},i=void 0,l={unversionedId:"Take-A-Break-Reminder-App/Creating-Interface-File-JWT",id:"Take-A-Break-Reminder-App/Creating-Interface-File-JWT",title:"6. Creating the Interface file for JWT",description:"In the root of the project, create a file called next-auth.d.ts and include the following code:",source:"@site/docs/Take-A-Break-Reminder-App/06-Creating-Interface-File-JWT.md",sourceDirName:"Take-A-Break-Reminder-App",slug:"/Take-A-Break-Reminder-App/Creating-Interface-File-JWT",permalink:"/MicrosoftCloud/tutorials/docs/Take-A-Break-Reminder-App/Creating-Interface-File-JWT",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"6. Creating the Interface file for JWT",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"5. Important Changes in the Reminder Page",permalink:"/MicrosoftCloud/tutorials/docs/Take-A-Break-Reminder-App/Important-Changes-Reminder-Page"},next:{title:"7. Next Steps & Final Words",permalink:"/MicrosoftCloud/tutorials/docs/Take-A-Break-Reminder-App/Next Steps-Conclusion"}},p={},s=[],u={toc:s};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In the root of the project, create a file called ",(0,a.kt)("inlineCode",{parentName:"p"},"next-auth.d.ts")," and include the following code:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"next-auth.d.ts"))),(0,a.kt)("details",null,(0,a.kt)("summary",null,(0,a.kt)("b",null,"pages/reminder.tsx")),(0,a.kt)("br",null),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},'import "next-auth/jwt"\n\n// Read more at: https://next-auth.js.org/getting-started/typescript#module-augmentation\n\ndeclare module "next-auth/jwt" {\n  interface JWT {\n    userRole?: "admin",\n    accessToken?: string,\n    refreshToken?: string,\n  }\n}\n'))),(0,a.kt)("br",null),(0,a.kt)("p",null,"Nothing very complicated here. But it is important that you understand what is happening here. The ",(0,a.kt)("inlineCode",{parentName:"p"},"next-auth/jwt")," is a module that exports an interface called ",(0,a.kt)("inlineCode",{parentName:"p"},"JWT"),". We are telling TypeScript that we want to extend this interface with the properties ",(0,a.kt)("inlineCode",{parentName:"p"},"userRole"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"accessToken")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"refreshToken"),". This allows us to access these properties anywhere in our code. For example, if you try to access ",(0,a.kt)("inlineCode",{parentName:"p"},"session.userRole")," somewhere in your code, TypeScript won't complain. This is very useful because you don't need to import the ",(0,a.kt)("inlineCode",{parentName:"p"},"session")," everywhere. You can simply access the properties you need."),(0,a.kt)("p",null,"This means TypeScript Augmentation. ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"https://next-auth.js.org/getting-started/typescript#module-augmentation"},"You can read more about it")),"."),(0,a.kt)("p",null,"Finally we can test our application. Run the command ",(0,a.kt)("inlineCode",{parentName:"p"},"npm run dev")," and access the application at ",(0,a.kt)("inlineCode",{parentName:"p"},"http://localhost:3000/reminder"),". "),(0,a.kt)("p",null,"Make the login using the credentials you created in the previous step. If everything is ok, your name will be displayed on the screen."),(0,a.kt)("p",null,"Before to click in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Start Timer")," button, you will need to connect on Microsoft Teams. Remember that you will need to use the email that you created before in the M365 Developer Program."),(0,a.kt)("p",null,"Let your status as ",(0,a.kt)("inlineCode",{parentName:"p"},"Available"),"."),(0,a.kt)("p",null,"Return to the application and click in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Start Timer")," button. Wait for 2 minutes. After that, an alert message will pop up in your screen saying: ",(0,a.kt)("inlineCode",{parentName:"p"},"Take a break!"),"."),(0,a.kt)("p",null,"But if the user has a status differente from ",(0,a.kt)("inlineCode",{parentName:"p"},"Available"),"? What will happen? If you try to click in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Start Timer"),", it will inform you that you're ",(0,a.kt)("inlineCode",{parentName:"p"},"Offline")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"Busy")," or any other status different from ",(0,a.kt)("inlineCode",{parentName:"p"},"Available"),"."),(0,a.kt)("p",null,"And, congratulations! You have created a simple application that uses the Microsoft Graph API to get the user status and the NextAuth to authenticate the user. "),(0,a.kt)("p",null,"Did you like this workshop? If you want to learn more about the Microsoft Graph API, in the next session I will let some important links for you to continue your studies."))}c.isMDXComponent=!0}}]);