"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[290],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>c});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=p(n),c=r,f=d["".concat(l,".").concat(c)]||d[c]||u[c]||a;return n?i.createElement(f,o(o({ref:t},m),{},{components:n})):i.createElement(f,o({ref:t},m))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<a;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4792:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var i=n(7462),r=(n(7294),n(3905));const a={title:"5. Important Changes in the Reminder Page",sidebar_position:1},o=void 0,s={unversionedId:"Take-A-Break-Reminder-App/Important-Changes-Reminder-Page",id:"Take-A-Break-Reminder-App/Important-Changes-Reminder-Page",title:"5. Important Changes in the Reminder Page",description:"Now that we have getPresence file, we need to update the reminder.tsx page to make the connection between the api with client-side in our application.",source:"@site/docs/Take-A-Break-Reminder-App/05-Important-Changes-Reminder-Page.md",sourceDirName:"Take-A-Break-Reminder-App",slug:"/Take-A-Break-Reminder-App/Important-Changes-Reminder-Page",permalink:"/MicrosoftCloud/tutorials/docs/Take-A-Break-Reminder-App/Important-Changes-Reminder-Page",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"5. Important Changes in the Reminder Page",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"4. Developing the GetPresence API",permalink:"/MicrosoftCloud/tutorials/docs/Take-A-Break-Reminder-App/Developing-Get-Presence-API"},next:{title:"6. Creating the Interface file for JWT",permalink:"/MicrosoftCloud/tutorials/docs/Take-A-Break-Reminder-App/Creating-Interface-File-JWT"}},l={},p=[],m={toc:p};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,i.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Now that we have ",(0,r.kt)("inlineCode",{parentName:"p"},"getPresence")," file, we need to update the ",(0,r.kt)("inlineCode",{parentName:"p"},"reminder.tsx")," page to make the connection between the api with client-side in our application."),(0,r.kt)("p",null,"Open the ",(0,r.kt)("inlineCode",{parentName:"p"},"reminder.tsx")," file and update the code as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"pages/reminder.tsx"),":")),(0,r.kt)("details",null,(0,r.kt)("summary",null,(0,r.kt)("b",null,"pages/reminder.tsx")),(0,r.kt)("br",null),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useSession } from 'next-auth/react';\nimport { useState } from 'react';\nimport Layout from '../components/Layout/layout';\n\nexport default function ReminderPage() {\n  const [isTimerStarted, setIsTimerStarted] = useState(false);\n  const { data: session, status } = useSession();\n  const isLoading = status === 'loading';\n\n  const isPresent = async () => {\n    const data = await fetch('/api/getPresence');\n    const presence = await data.json();\n    return !['Offline', 'Away'].includes(presence.availability);\n  };\n\n  const maybeAlert = async () => {\n    if (await isPresent()) {\n      alert('Take a Break!');\n    }\n  };\n\n  const startTimer = async () => {\n    if (!(await isPresent())) {\n      alert('You are offline!');\n      return;\n    }\n\n    // 60 minutes = 3600000 milliseconds\n    // 2 minutes = 120000 milliseconds\n    setTimeout(timerIsOver, 120000);\n\n    setIsTimerStarted(true);\n  };\n\n  const timerIsOver = async () => {\n    await maybeAlert();\n    setIsTimerStarted(false);\n  };\n\n  if (isLoading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <Layout>\n      <h1>Reminder Page</h1>\n      <h2>Welcome, {session?.user?.name}!</h2>\n\n      <div>\n        <h3>\u23f0 Time goes by... so slowly! \u23f0</h3>\n        {isTimerStarted ? (\n          <p>\n            {' '}\n            <strong>Timer is running right now...</strong>\n          </p>\n        ) : (\n          <button onClick={startTimer}>Start Timer!</button>\n        )}\n      </div>\n    </Layout>\n  );\n}\n"))),(0,r.kt)("br",null),(0,r.kt)("p",null,"Let's understand what we did in the code above. First, we imported the ",(0,r.kt)("inlineCode",{parentName:"p"},"useSession")," hook from ",(0,r.kt)("inlineCode",{parentName:"p"},"next-auth/react")," and the ",(0,r.kt)("inlineCode",{parentName:"p"},"useState")," hook from ",(0,r.kt)("inlineCode",{parentName:"p"},"react"),"."),(0,r.kt)("p",null,"Then, we created some variables such as ",(0,r.kt)("inlineCode",{parentName:"p"},"isTimerStarted"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"setIsTimerStarted")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"isLoading"),". All of them with initial status as ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,r.kt)("p",null,"Now, let's understand each functions from this page:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"isPresent")," - This function is responsible for checking if the user is present or not on Microsoft Teams. It makes this requesting the API that we created in the previous step and then, will check if the value ",(0,r.kt)("inlineCode",{parentName:"p"},"availability")," is different from ",(0,r.kt)("inlineCode",{parentName:"p"},"Offline")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"Away"),". If it is, it will return ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," and if not, it will return ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"maybeAlert")," - This function is responsible for checking if the user is present or not. If it is, it will show an alert message to the user.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"startTimer")," - This function will verify if the user is present (with status ",(0,r.kt)("inlineCode",{parentName:"p"},"Available"),") on Microsoft Teams. If so, it will start the timer for 60 minutes (what is 3600000 milliseconds). For demonstration purposes, we will set the timer for 2 minutes (what is 120000 milliseconds).")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"timerIsOver"),": This function will check if the user is present or not. If it is, it will show an alert message to the user. If not, it will set the ",(0,r.kt)("inlineCode",{parentName:"p"},"isTimerStarted")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"isLoading"),": This variable is responsible for checking if the page is loading or not."))),(0,r.kt)("p",null,"And in the ",(0,r.kt)("inlineCode",{parentName:"p"},"return")," block code in the ",(0,r.kt)("inlineCode",{parentName:"p"},"ReminderPage")," function, we will show the user's name and if the timer is running, it will show a message: ",(0,r.kt)("inlineCode",{parentName:"p"},"Timer is running right now..."),". If not, it will show a button: ",(0,r.kt)("inlineCode",{parentName:"p"},"Start Timer"),"."),(0,r.kt)("p",null,"And that's it! Before to test it out our application, there's an important file that we need to create. Let's make it in the next session!"))}u.isMDXComponent=!0}}]);